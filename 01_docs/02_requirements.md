# 2. 機能要件

## 2.1 Phase 1（MVP）

### 2.1.1 コンペ情報管理
**自動取得機能**
- Kaggle APIで過去・現在のコンペ情報を全件取得
- 初回セットアップ時に一括取得
- 日次バッチで新規コンペを自動追加

**取得する情報**
- コンペID（Kaggle上のユニークID）
- タイトル
- URL（Kaggleへのリンク）
- 開催期間（開始日・終了日）
- ステータス（開催中/終了済み）
- 評価指標（AUC, RMSE, F1など）
- 説明文（英語原文）

**LLM処理**
- GPT-4o miniで以下を生成：
  - 日本語要約（150文字程度）
  - タグの自動推測（最大5個）
  - データ種別の判定
  - ドメインの分類

### 2.1.2 ホーム画面

**画面構成**
1. ダッシュボード（統計情報の可視化）
2. 検索バー
3. フィルター
4. コンペ一覧テーブル
5. ページネーション

**ダッシュボード**

*サマリー統計*
- 全コンペ数：総登録コンペ数を表示
- 開催中のコンペ数：現在開催中のコンペ数を表示
- 表示形式：2つの数字カード（横並び）

*開催中コンペのカード表示*
- 最大12件を横スクロール形式で表示
- カード内容：
  - タイトル
  - ステータス（🟢 開催中）+ 残り日数
  - 概要（2-3行、60-90文字）
  - タグ（最大3個、バッジ形式）
  - 評価指標
  - 「詳細を見る」リンク
- ソート：残り日数が少ない順（デフォルト）
- 「すべて見る」リンク → 開催中でフィルタした一覧表示
- レスポンシブ：PC 4枚、タブレット 2-3枚、スマホ 1-2枚同時表示
- インタラクション：カード全体クリックでコンペ詳細画面へ遷移

*年別コンペ数の推移*
- 2020年以降の年別集計を棒グラフまたは折れ線グラフで表示
- X軸：年（2020, 2021, 2022...）
- Y軸：コンペ数
- インタラクション：棒をクリックすると該当年でフィルタ
- フィルター連動：フィルタ適用時は該当データのみ集計

*データ種別の分布*
- 横棒グラフで表示
- データ種別：
  - テーブル（tabular）
  - 画像（image）
  - テキスト（text）
  - 時系列（time-series）
  - 音声（audio）
  - 動画（video）
- 各棒の右端に件数を表示
- インタラクション：棒をクリックすると該当データ種別でフィルタ
- フィルター連動：フィルタ適用時は該当データのみ集計
- 注：マルチモーダル（複数データ種別）のコンペは重複カウント

**コンペ一覧テーブル**

*表示形式*
- テーブル形式（1ページ20件）

*表示項目*
| カラム | 内容 | ソート可否 |
|--------|------|-----------|
| ステータス | 🟢開催中 / 🔴終了済み | ✅ |
| タイトル | コンペ名（クリックで詳細へ） | ✅ |
| 期間 | YYYY/MM-MM | ✅ |
| 評価指標 | AUC, RMSE等 | ✅ |
| タグ | バッジ表示（最大3個、ホバーで全表示） | - |
| ステータス | 未着手 / 📝ディスカッションのみ / ✅解法分析済み<br>💬 ディスカッション数 | ✅ |

**検索機能**
- フリーワード検索
- 検索対象：タイトル、タグ、要約文
- リアルタイム検索（debounce 300ms）

**フィルター機能**
1. **ステータス**（単一選択）
   - すべて（デフォルト）
   - 🟢 開催中
   - 🔴 終了済み

2. **タグ**（複数選択可）
   - 課題系：不均衡データ、異常検知、欠損値、時系列、マルチモーダル
   - データ系：テーブルデータ、画像、テキスト、音声、動画
   - 手法系：アンサンブル、Transformer、GBM、深層学習、擬似ラベリング
   - ドメイン系：医療、金融、Eコマース、自然言語処理、コンピュータビジョン

3. **データ種別**（複数選択可）
   - テーブル、画像、テキスト、時系列、音声、動画

4. **評価指標**（複数選択可）
   - AUC、F1、Accuracy、RMSE/MAE、LogLoss、MAP@K、Dice、IoU

5. **解法ステータス**（単一選択）
   - すべて
   - 未着手
   - 📝 ディスカッションのみ
   - ✅ 解法分析済み

6. **開催年**（ドロップダウン）
   - すべて、2025、2024、2023...2015以前

**ソート機能**
- 終了日（新しい順）← デフォルト
- 終了日（古い順）
- 登録日（新しい順）
- 登録日（古い順）
- タイトル（A-Z）
- タイトル（Z-A）

**ページネーション**
- 1ページ20件表示
- ページ番号クリックで遷移
- 前へ/次へボタン
- 現在ページ数 / 全ページ数を表示

### 2.1.3 コンペ詳細画面
**基本情報セクション**
- タイトル
- Kaggleへのリンク（🔗アイコン + URL）
- 開催期間
- ステータス（開催中/終了済み）
- 評価指標
- タグ（バッジ表示、編集可能）
- 概要（日本語要約）
- 説明文（英語原文、折りたたみ可能）

**ディスカッションセクション**
- 「ディスカッション追加」ボタン（Phase 2で実装）
- ディスカッション一覧（Phase 2で実装）
- ※Phase 1では空のセクションとして準備のみ

**上位解法セクション**
- 「解法を追加」ボタン（Phase 3で実装）
- 解法一覧（Phase 3で実装）
- ※Phase 1では空のセクションとして準備のみ

## 2.2 Phase 2（ディスカッション機能）

### 2.2.1 ディスカッション取得
**取得方法**
- Playwright（ブラウザ自動化）によるスクレイピング

**2段階の取得プロセス**

**Step 1: 一覧取得（基本情報のみ）**
- URL: `https://www.kaggle.com/c/{competition-id}/discussion`
- 取得情報：
  - タイトル
  - Vote数（いいね数）
  - 投稿者名
  - ディスカッションURL
  - コメント数
  - 投稿日時

**Step 2: 詳細取得（選択的）**
- ユーザーが選択したディスカッションのみ
- 取得情報：
  - 本文（内容）
  - コメント（オプション）
  - 投稿者のメダル情報

**フィルタリング**
- Vote数：50以上
- 投稿者：金メダル保有者
- ユーザーが手動で選択

### 2.2.2 ディスカッション整理（LLM処理）
**カテゴリ分類**（8種類）
1. 📊 データ分析・EDA
2. 🔧 特徴量エンジニアリング
3. 🤖 モデル・手法
4. ✅ バリデーション戦略
5. ⚠️ リーク・注意点
6. 💡 アイデア・洞察
7. 🐛 バグ・修正
8. 📚 参考資料

**生成内容**
- カテゴリ（上記8つから1つ）
- 日本語要約（100-150文字）
- キーポイント（最大3つ）
- 関連タグ

### 2.2.3 ディスカッション表示
**一覧表示（コンペ詳細画面内）**

テーブル形式：
| カテゴリ | タイトル | 投稿者 | Vote | 要約 | リンク |
|---------|---------|--------|------|------|--------|
| 📊 EDA | Target distribution | John 🥇×3 | 245 | ... | [🔗] |

**フィルター機能**
- カテゴリ（複数選択可）
- Vote数（スライダーで下限設定）
- 投稿者フィルター：
  - すべて
  - 金メダリストのみ
  - Master以上のみ

**ソート機能**
- Vote数順
- 投稿日順
- 金メダル数順

## 2.3 Phase 3（上位解法分析）

### 2.3.1 上位解法の記録
**対象**
- 1位〜20位の解法

**記録する情報（各順位ごと）**
- 順位
- チーム名/参加者名
- スコア
- Solution URL
- モデル構成（単一/アンサンブル）
- 前処理・特徴量エンジニアリング
- 学習戦略（CV戦略、ハイパーパラメータ）
- 特記事項

### 2.3.2 解法分析
**共通点の分析**
- ほぼ全員が採用（15人以上）
- 多数派（10-15人）
- 効果的少数派（3-5人）

**分析観点**
- 前処理（欠損値補完、正規化など）
- 特徴量（共通して使われた特徴量）
- モデル（使用率、アンサンブル手法）
- CV戦略（StratifiedKFold、GroupKFoldなど）

**差別化ポイント**
- TOP5のみが採用した手法
- 順位帯による手法の違い
- ユニークなアプローチ

### 2.3.3 解法表示
**個別解法テーブル**
- 1-20位の一覧
- ソート・フィルタ機能
- 各解法の詳細（展開可能）

**分析サマリー**
- 共通点（採用率の可視化：棒グラフなど）
- 差別化ポイント
- ディスカッションの重要ポイント

---

**関連ドキュメント:**
- [システム概要](./01_overview.md)
- [データ設計](./03_data_design.md)
- [API設計](./07_api_design.md)
- [フロントエンド仕様](./10_frontend_spec.md)
